# TODO secure mysql and rabbit

- name: Install mysql and rabbitmq
  apt: pkg={{item}} state=installed
  with_items:
    - mysql-server
    - rabbitmq-server
    - python-mysqldb

- name: Configure mysql access
  template: src=mysql.cnf dest=/etc/mysql/conf.d/devcloud-ansible.cnf
  notify: restart-mysql

- name: Configure an OpenStack DB user
  mysql_user: host=% name={{nova_user}} password={{nova_pass}} priv=*.*:ALL state=present

- name: Configure an OpenStack Rabbit user
  rabbitmq_user: user={{rabbit_user}} password={{rabbit_pass}} vhost=/
                 configure_priv=.* read_priv=.* write_priv=.* state=present
